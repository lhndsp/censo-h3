
WITH
    -- Preencher setores
    setores_polyfill AS (
        SELECT
            jslibs.h3.ST_H3_POLYFILLFROMGEOG(geometria , 9) as geo
        FROM `basedosdados.br_geobr_mapas.setor_censitario_2010`
            WHERE zona = 'URBANO' AND geometria IS NOT NULL
    ),
    -- Malha H3
    h3_hexagons as (
    SELECT
        h3,
        jslibs.h3.ST_H3_BOUNDARY(h3) as h3geo
    FROM setores_polyfill, UNNEST(geo) as h3
    ),
    -- Calculo
    geom_overlap AS(
      SELECT
          h3_hexagons.h3,
          h3_hexagons.h3geo,
          ST_AREA(ST_INTERSECTION(h3geo, setor_geom.geometria)) as intersection_h3,
          ST_AREA(geometria) as setor_area,
raca_idade_gen.v001 AS v001,
raca_idade_gen.v002 AS v002,
raca_idade_gen.v003 AS v003,
raca_idade_gen.v004 AS v004,
raca_idade_gen.v005 AS v005,
raca_idade_gen.v006 AS v006,
raca_idade_gen.v007 AS v007,
raca_idade_gen.v008 AS v008,
raca_idade_gen.v009 AS v009,
raca_idade_gen.v010 AS v010,
raca_idade_gen.v011 AS v011,
raca_idade_gen.v012 AS v012,
raca_idade_gen.v013 AS v013,
raca_idade_gen.v014 AS v014,
raca_idade_gen.v015 AS v015,
raca_idade_gen.v016 AS v016,
raca_idade_gen.v017 AS v017,
raca_idade_gen.v018 AS v018,
raca_idade_gen.v019 AS v019,
raca_idade_gen.v020 AS v020,
raca_idade_gen.v021 AS v021,
raca_idade_gen.v022 AS v022,
raca_idade_gen.v023 AS v023,
raca_idade_gen.v024 AS v024,
raca_idade_gen.v025 AS v025,
raca_idade_gen.v026 AS v026,
raca_idade_gen.v027 AS v027,
raca_idade_gen.v028 AS v028,
raca_idade_gen.v029 AS v029,
raca_idade_gen.v030 AS v030,
raca_idade_gen.v031 AS v031,
raca_idade_gen.v032 AS v032,
raca_idade_gen.v033 AS v033,
raca_idade_gen.v034 AS v034,
raca_idade_gen.v035 AS v035,
raca_idade_gen.v036 AS v036,
raca_idade_gen.v037 AS v037,
raca_idade_gen.v038 AS v038,
raca_idade_gen.v039 AS v039,
raca_idade_gen.v040 AS v040,
raca_idade_gen.v041 AS v041,
raca_idade_gen.v042 AS v042,
raca_idade_gen.v043 AS v043,
raca_idade_gen.v044 AS v044,
raca_idade_gen.v045 AS v045,
raca_idade_gen.v046 AS v046,
raca_idade_gen.v047 AS v047,
raca_idade_gen.v048 AS v048,
raca_idade_gen.v049 AS v049,
raca_idade_gen.v050 AS v050,
raca_idade_gen.v051 AS v051,
raca_idade_gen.v052 AS v052,
raca_idade_gen.v053 AS v053,
raca_idade_gen.v054 AS v054,
raca_idade_gen.v055 AS v055,
raca_idade_gen.v056 AS v056,
raca_idade_gen.v057 AS v057,
raca_idade_gen.v058 AS v058,
raca_idade_gen.v059 AS v059,
raca_idade_gen.v060 AS v060,
raca_idade_gen.v061 AS v061,
raca_idade_gen.v062 AS v062,
raca_idade_gen.v063 AS v063,
raca_idade_gen.v064 AS v064,
raca_idade_gen.v065 AS v065,
raca_idade_gen.v066 AS v066,
raca_idade_gen.v067 AS v067,
raca_idade_gen.v068 AS v068,
raca_idade_gen.v069 AS v069,
raca_idade_gen.v070 AS v070,
raca_idade_gen.v071 AS v071,
raca_idade_gen.v072 AS v072,
raca_idade_gen.v073 AS v073,
raca_idade_gen.v074 AS v074,
raca_idade_gen.v075 AS v075,
raca_idade_gen.v076 AS v076,
raca_idade_gen.v077 AS v077,
raca_idade_gen.v078 AS v078,
raca_idade_gen.v079 AS v079,
raca_idade_gen.v080 AS v080,
raca_idade_gen.v081 AS v081,
raca_idade_gen.v082 AS v082,
raca_idade_gen.v083 AS v083,
raca_idade_gen.v084 AS v084,
raca_idade_gen.v085 AS v085,
raca_idade_gen.v086 AS v086,
raca_idade_gen.v087 AS v087,
raca_idade_gen.v088 AS v088,
raca_idade_gen.v089 AS v089,
raca_idade_gen.v090 AS v090,
raca_idade_gen.v091 AS v091,
raca_idade_gen.v092 AS v092,
raca_idade_gen.v093 AS v093,
raca_idade_gen.v094 AS v094,
raca_idade_gen.v095 AS v095,
raca_idade_gen.v096 AS v096,
raca_idade_gen.v097 AS v097,
raca_idade_gen.v098 AS v098,
raca_idade_gen.v099 AS v099,
raca_idade_gen.v100 AS v100,
raca_idade_gen.v101 AS v101,
raca_idade_gen.v102 AS v102,
raca_idade_gen.v103 AS v103,
raca_idade_gen.v104 AS v104,
raca_idade_gen.v105 AS v105,
raca_idade_gen.v106 AS v106,
raca_idade_gen.v107 AS v107,
raca_idade_gen.v108 AS v108,
raca_idade_gen.v109 AS v109,
raca_idade_gen.v110 AS v110,
raca_idade_gen.v111 AS v111,
raca_idade_gen.v112 AS v112,
raca_idade_gen.v113 AS v113,
raca_idade_gen.v114 AS v114,
raca_idade_gen.v115 AS v115,
raca_idade_gen.v116 AS v116,
raca_idade_gen.v117 AS v117,
raca_idade_gen.v118 AS v118,
raca_idade_gen.v119 AS v119,
raca_idade_gen.v120 AS v120,
raca_idade_gen.v121 AS v121,
raca_idade_gen.v122 AS v122,
raca_idade_gen.v123 AS v123,
raca_idade_gen.v124 AS v124,
raca_idade_gen.v125 AS v125,
raca_idade_gen.v126 AS v126,
raca_idade_gen.v127 AS v127,
raca_idade_gen.v128 AS v128,
raca_idade_gen.v129 AS v129,
raca_idade_gen.v130 AS v130,
raca_idade_gen.v131 AS v131,
raca_idade_gen.v132 AS v132,
raca_idade_gen.v133 AS v133,
raca_idade_gen.v134 AS v134,
raca_idade_gen.v135 AS v135,
raca_idade_gen.v136 AS v136,
raca_idade_gen.v137 AS v137,
raca_idade_gen.v138 AS v138,
raca_idade_gen.v139 AS v139,
raca_idade_gen.v140 AS v140,
raca_idade_gen.v141 AS v141,
raca_idade_gen.v142 AS v142,
raca_idade_gen.v143 AS v143,
raca_idade_gen.v144 AS v144,
raca_idade_gen.v145 AS v145,
raca_idade_gen.v146 AS v146,
raca_idade_gen.v147 AS v147,
raca_idade_gen.v148 AS v148,
raca_idade_gen.v149 AS v149,
raca_idade_gen.v150 AS v150,
raca_idade_gen.v151 AS v151,
raca_idade_gen.v152 AS v152,
raca_idade_gen.v153 AS v153,
raca_idade_gen.v154 AS v154,
raca_idade_gen.v155 AS v155,
raca_idade_gen.v156 AS v156,
raca_idade_gen.v157 AS v157,
raca_idade_gen.v158 AS v158,
raca_idade_gen.v159 AS v159,
raca_idade_gen.v160 AS v160,
raca_idade_gen.v161 AS v161,
raca_idade_gen.v162 AS v162,
raca_idade_gen.v163 AS v163,
raca_idade_gen.v164 AS v164,
raca_idade_gen.v165 AS v165,
raca_idade_gen.v166 AS v166,
raca_idade_gen.v167 AS v167,
raca_idade_gen.v168 AS v168,
raca_idade_gen.v169 AS v169,
raca_idade_gen.v170 AS v170,
raca_idade_gen.v171 AS v171,
raca_idade_gen.v172 AS v172,
raca_idade_gen.v173 AS v173,
raca_idade_gen.v174 AS v174,
raca_idade_gen.v175 AS v175,
raca_idade_gen.v176 AS v176,
raca_idade_gen.v177 AS v177,
raca_idade_gen.v178 AS v178,
raca_idade_gen.v179 AS v179,
raca_idade_gen.v180 AS v180,
raca_idade_gen.v181 AS v181,
raca_idade_gen.v182 AS v182,
raca_idade_gen.v183 AS v183,
raca_idade_gen.v184 AS v184,
raca_idade_gen.v185 AS v185,
raca_idade_gen.v186 AS v186,
raca_idade_gen.v187 AS v187,
raca_idade_gen.v188 AS v188,
raca_idade_gen.v189 AS v189,
raca_idade_gen.v190 AS v190,
raca_idade_gen.v191 AS v191,
raca_idade_gen.v192 AS v192,
raca_idade_gen.v193 AS v193,
raca_idade_gen.v194 AS v194,
raca_idade_gen.v195 AS v195,
raca_idade_gen.v196 AS v196,
raca_idade_gen.v197 AS v197,
raca_idade_gen.v198 AS v198,
raca_idade_gen.v199 AS v199,
raca_idade_gen.v200 AS v200,
raca_idade_gen.v201 AS v201,
raca_idade_gen.v202 AS v202,
raca_idade_gen.v203 AS v203,
raca_idade_gen.v204 AS v204,
raca_idade_gen.v205 AS v205,
raca_idade_gen.v206 AS v206,
raca_idade_gen.v207 AS v207,
raca_idade_gen.v208 AS v208,
raca_idade_gen.v209 AS v209,
raca_idade_gen.v210 AS v210,
raca_idade_gen.v211 AS v211,
raca_idade_gen.v212 AS v212,
raca_idade_gen.v213 AS v213,
raca_idade_gen.v214 AS v214,
raca_idade_gen.v215 AS v215,
raca_idade_gen.v216 AS v216,
raca_idade_gen.v217 AS v217,
raca_idade_gen.v218 AS v218,
raca_idade_gen.v219 AS v219,
raca_idade_gen.v220 AS v220,
raca_idade_gen.v221 AS v221,
raca_idade_gen.v222 AS v222,
raca_idade_gen.v223 AS v223,
raca_idade_gen.v224 AS v224,
raca_idade_gen.v225 AS v225,
raca_idade_gen.v226 AS v226,
raca_idade_gen.v227 AS v227,
raca_idade_gen.v228 AS v228,
raca_idade_gen.v229 AS v229,
raca_idade_gen.v230 AS v230,
raca_idade_gen.v231 AS v231,
raca_idade_gen.v232 AS v232,
raca_idade_gen.v233 AS v233,
raca_idade_gen.v234 AS v234,
raca_idade_gen.v235 AS v235,
raca_idade_gen.v236 AS v236,
raca_idade_gen.v237 AS v237,
raca_idade_gen.v238 AS v238,
raca_idade_gen.v239 AS v239,
raca_idade_gen.v240 AS v240,
raca_idade_gen.v241 AS v241,
raca_idade_gen.v242 AS v242,
raca_idade_gen.v243 AS v243,
raca_idade_gen.v244 AS v244,
raca_idade_gen.v245 AS v245,
raca_idade_gen.v246 AS v246,
raca_idade_gen.v247 AS v247,
raca_idade_gen.v248 AS v248,
raca_idade_gen.v249 AS v249,
raca_idade_gen.v250 AS v250,
raca_idade_gen.v251 AS v251

FROM h3_hexagons
JOIN `basedosdados.br_geobr_mapas.setor_censitario_2010` setor_geom
    ON ST_INTERSECTS(h3_hexagons.h3geo, setor_geom.geometria)
JOIN `basedosdados.br_ibge_censo_demografico.setor_censitario_raca_idade_genero_2010` raca_idade_gen USING(id_setor_censitario))
SELECT
    h3,
    ANY_VALUE(h3geo) as geometry,
    ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v001)) as v001,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v002)) as v002,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v003)) as v003,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v004)) as v004,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v005)) as v005,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v006)) as v006,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v007)) as v007,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v008)) as v008,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v009)) as v009,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v010)) as v010,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v011)) as v011,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v012)) as v012,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v013)) as v013,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v014)) as v014,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v015)) as v015,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v016)) as v016,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v017)) as v017,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v018)) as v018,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v019)) as v019,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v020)) as v020,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v021)) as v021,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v022)) as v022,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v023)) as v023,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v024)) as v024,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v025)) as v025,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v026)) as v026,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v027)) as v027,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v028)) as v028,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v029)) as v029,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v030)) as v030,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v031)) as v031,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v032)) as v032,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v033)) as v033,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v034)) as v034,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v035)) as v035,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v036)) as v036,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v037)) as v037,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v038)) as v038,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v039)) as v039,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v040)) as v040,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v041)) as v041,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v042)) as v042,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v043)) as v043,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v044)) as v044,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v045)) as v045,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v046)) as v046,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v047)) as v047,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v048)) as v048,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v049)) as v049,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v050)) as v050,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v051)) as v051,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v052)) as v052,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v053)) as v053,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v054)) as v054,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v055)) as v055,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v056)) as v056,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v057)) as v057,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v058)) as v058,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v059)) as v059,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v060)) as v060,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v061)) as v061,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v062)) as v062,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v063)) as v063,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v064)) as v064,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v065)) as v065,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v066)) as v066,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v067)) as v067,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v068)) as v068,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v069)) as v069,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v070)) as v070,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v071)) as v071,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v072)) as v072,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v073)) as v073,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v074)) as v074,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v075)) as v075,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v076)) as v076,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v077)) as v077,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v078)) as v078,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v079)) as v079,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v080)) as v080,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v081)) as v081,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v082)) as v082,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v083)) as v083,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v084)) as v084,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v085)) as v085,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v086)) as v086,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v087)) as v087,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v088)) as v088,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v089)) as v089,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v090)) as v090,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v091)) as v091,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v092)) as v092,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v093)) as v093,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v094)) as v094,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v095)) as v095,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v096)) as v096,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v097)) as v097,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v098)) as v098,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v099)) as v099,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v100)) as v100,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v101)) as v101,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v102)) as v102,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v103)) as v103,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v104)) as v104,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v105)) as v105,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v106)) as v106,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v107)) as v107,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v108)) as v108,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v109)) as v109,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v110)) as v110,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v111)) as v111,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v112)) as v112,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v113)) as v113,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v114)) as v114,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v115)) as v115,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v116)) as v116,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v117)) as v117,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v118)) as v118,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v119)) as v119,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v120)) as v120,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v121)) as v121,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v122)) as v122,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v123)) as v123,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v124)) as v124,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v125)) as v125,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v126)) as v126,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v127)) as v127,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v128)) as v128,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v129)) as v129,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v130)) as v130,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v131)) as v131,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v132)) as v132,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v133)) as v133,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v134)) as v134,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v135)) as v135,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v136)) as v136,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v137)) as v137,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v138)) as v138,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v139)) as v139,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v140)) as v140,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v141)) as v141,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v142)) as v142,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v143)) as v143,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v144)) as v144,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v145)) as v145,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v146)) as v146,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v147)) as v147,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v148)) as v148,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v149)) as v149,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v150)) as v150,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v151)) as v151,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v152)) as v152,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v153)) as v153,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v154)) as v154,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v155)) as v155,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v156)) as v156,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v157)) as v157,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v158)) as v158,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v159)) as v159,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v160)) as v160,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v161)) as v161,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v162)) as v162,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v163)) as v163,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v164)) as v164,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v165)) as v165,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v166)) as v166,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v167)) as v167,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v168)) as v168,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v169)) as v169,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v170)) as v170,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v171)) as v171,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v172)) as v172,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v173)) as v173,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v174)) as v174,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v175)) as v175,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v176)) as v176,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v177)) as v177,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v178)) as v178,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v179)) as v179,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v180)) as v180,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v181)) as v181,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v182)) as v182,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v183)) as v183,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v184)) as v184,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v185)) as v185,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v186)) as v186,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v187)) as v187,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v188)) as v188,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v189)) as v189,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v190)) as v190,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v191)) as v191,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v192)) as v192,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v193)) as v193,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v194)) as v194,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v195)) as v195,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v196)) as v196,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v197)) as v197,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v198)) as v198,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v199)) as v199,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v200)) as v200,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v201)) as v201,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v202)) as v202,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v203)) as v203,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v204)) as v204,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v205)) as v205,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v206)) as v206,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v207)) as v207,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v208)) as v208,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v209)) as v209,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v210)) as v210,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v211)) as v211,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v212)) as v212,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v213)) as v213,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v214)) as v214,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v215)) as v215,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v216)) as v216,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v217)) as v217,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v218)) as v218,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v219)) as v219,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v220)) as v220,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v221)) as v221,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v222)) as v222,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v223)) as v223,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v224)) as v224,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v225)) as v225,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v226)) as v226,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v227)) as v227,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v228)) as v228,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v229)) as v229,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v230)) as v230,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v231)) as v231,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v232)) as v232,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v233)) as v233,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v234)) as v234,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v235)) as v235,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v236)) as v236,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v237)) as v237,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v238)) as v238,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v239)) as v239,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v240)) as v240,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v241)) as v241,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v242)) as v242,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v243)) as v243,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v244)) as v244,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v245)) as v245,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v246)) as v246,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v247)) as v247,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v248)) as v248,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v249)) as v249,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v250)) as v250,
ROUND(SUM(SAFE_DIVIDE(intersection_h3, setor_area) * v251)) as v251
FROM geom_overlap
  GROUP BY h3
